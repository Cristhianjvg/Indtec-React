(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{697:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,1290,23)),Promise.resolve().then(r.bind(r,2711))},1290:()=>{},2711:(e,t,r)=>{"use strict";r.d(t,{default:()=>p});var s=r(5155);class n{async hash(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>e.toString(16).padStart(2,"0")).join("")}async generateHeaderID(){let e=[];try{var t,r,s,n,a,l,o,i,c,d;if(e.push(navigator.userAgent),e.push(navigator.platform),e.push(navigator.product),e.push(navigator.productSub),e.push(navigator.vendor),e.push(navigator.vendorSub),e.push(null!=(s=null==(t=navigator.plugins)?void 0:t.length)?s:0),navigator.plugins){let t=[];for(let e=0;e<navigator.plugins.length;e++)t.push(null!=(a=null==(n=navigator.plugins[e])?void 0:n.name)?a:"");e.push(t.join("|"))}else e.push("");if(e.push(null!=(l=null==(r=navigator.mimeTypes)?void 0:r.length)?l:0),navigator.mimeTypes){let t=[];for(let e=0;e<navigator.mimeTypes.length;e++)t.push(null!=(i=null==(o=navigator.mimeTypes[e])?void 0:o.type)?i:"");e.push(t.join("|"))}else e.push("");e.push(null!=(c=navigator.languages)?c:[]),e.push(null!=(d=navigator.hardwareConcurrency)?d:0);let u=0;for(let e in navigator)Object.prototype.hasOwnProperty.call(navigator,e)&&u++;e.push(u)}catch(e){}return this.hash(JSON.stringify(e))}async generateCanvasID(){try{let e=document.createElement("canvas");e.height=100,e.width=800;let t=e.getContext("2d");t&&(t.font="30px Arial",t.fillText("Hello World",20,90));let r=e.toDataURL();return this.hash(r)}catch(e){return this.hash("canvas-fallback")}}async generateWebGlID(){try{let e=document.createElement("canvas"),t=e.getContext("webgl2")||e.getContext("webgl"),r=[];if(t)try{let e=t.getParameter(7937),s=t.getParameter(7936);if(r.push(String(e)),r.push(String(s)),t.getExtension("WEBGL_debug_renderer_info")){let e=t.getParameter(37446),s=t.getParameter(37445);r.push(String(e)),r.push(String(s))}}catch(e){}return this.hash(JSON.stringify(r))}catch(e){return this.hash("webgl-fallback")}}async getIPAddress(){try{let e=await fetch("https://api.ipify.org?format=json"),t=await e.json();return localStorage.setItem("KEY_DEVICE_ADDRESS",t.ip),t.ip||"0.0.0.0"}catch(e){return"0.0.0.0"}}async completeID(){let[e,t,r,s]=await Promise.all([this.generateHeaderID(),this.generateCanvasID(),this.generateWebGlID(),this.getIPAddress()]);return this.hash(e+t+r+s)}}var a=r(2115),l=r(63),o=r(6504),i=r(4514),c=r(8192),d=r(508);let u=e=>{let{chat:t}=e,r="model"===t.role;return(0,s.jsxs)("div",{className:"flex gap-3 items-start ".concat(r?"":"flex-row-reverse"),children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ".concat(r?"bg-[#0d475b]":"bg-[#ff6b35]"),children:r?(0,s.jsx)(c.A,{className:"w-4 h-4 text-white"}):(0,s.jsx)(d.A,{className:"w-4 h-4 text-white"})}),(0,s.jsx)("div",{className:"rounded-lg p-3 shadow-sm max-w-[80%] ".concat(r?"bg-white rounded-tl-none":"bg-[#ff6b35] text-white rounded-tr-none"),children:(0,s.jsx)("div",{className:"text-sm prose prose-sm max-w-none ".concat(r?"":"prose-invert"),children:(0,s.jsx)(o.oz,{remarkPlugins:[i.A],components:{ul:e=>{let{...t}=e;return(0,s.jsx)("ul",{className:"list-disc ml-4 my-2",...t})},ol:e=>{let{...t}=e;return(0,s.jsx)("ol",{className:"list-decimal ml-4 my-2",...t})},strong:e=>{let{...t}=e;return(0,s.jsx)("strong",{className:"font-bold",...t})},code:e=>{let{inline:t,...r}=e;return t?(0,s.jsx)("code",{className:"bg-gray-100 text-gray-800 px-1 py-0.5 rounded text-xs",...r}):(0,s.jsx)("code",{className:"block bg-gray-100 text-gray-800 p-2 rounded text-xs overflow-x-auto",...r})},p:e=>{let{...t}=e;return(0,s.jsx)("p",{className:"mb-2 last:mb-0",...t})}},children:t.text||""})})})]})};var h=r(8085);let g=e=>{let{chatHistory:t,setChatHistory:r,generateBotResponse:n}=e,l=(0,a.useRef)(null),o=async e=>{var s;e.preventDefault();let a=null==(s=l.current)?void 0:s.value.trim();a&&(l.current&&(l.current.value=""),r(e=>[...e,{role:"user",text:a}]),setTimeout(()=>r(e=>[...e,{role:"model",text:"Thinking..."}]),300),await n([...t,{role:"user",text:a}]))};return(0,s.jsxs)("form",{onSubmit:o,className:"flex gap-2 items-center",children:[(0,s.jsx)("input",{type:"text",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0d475b] focus:border-transparent text-sm",placeholder:"Escribe un mensaje...",ref:l}),(0,s.jsx)("button",{type:"submit",className:"bg-[#ff6b35] hover:bg-[#e55a2a] text-white rounded-lg p-2 transition-colors flex items-center justify-center",children:(0,s.jsx)(h.A,{className:"h-5 w-5"})})]})},m=()=>(0,s.jsx)(c.A,{className:"w-6 h-6 text-white"});async function x(){try{let e=new n,t=await e.completeID();localStorage.setItem("KEY_ID_DEVICE",t)}catch(e){console.warn("Error inicializando ID del dispositivo:",e),localStorage.setItem("KEY_ID_DEVICE",navigator.userAgent||"unknown")}}let p=()=>{let e=function(e){return e.includes("/indtec")?["INDTEC"]:e.includes("/congreso")?["CONGRESO"]:e.includes("/tarifa")?["TARIFA"]:e.includes("/trabajos")?["TRABAJOS"]:e.includes("/eventos")?["EVENTOS"]:[]}((0,l.usePathname)()),[t,r]=(0,a.useState)([]),[n,o]=(0,a.useState)(!1),i=(0,a.useRef)(null),d=async t=>{let s=e=>{r(t=>[...t.filter(e=>"Thinking..."!==e.text),{role:"model",text:e}])};try{let r=localStorage.getItem("KEY_ID_DEVICE")||"unknown",n=localStorage.getItem("KEY_DEVICE_ADDRESS")||"0.0.0.0",a=t[t.length-1],l=await fetch("/api/chatbot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:a.text,idDevice:r,deviceAddress:n,eventFilter:e})});if(!l.ok){let e=await l.json();throw Error(e.error||"Failed to get response")}let o=await l.json(),i=o.response||o.message||"Lo siento, no pude generar una respuesta.";s(i)}catch(e){console.error("Error generating bot response:",e),s("Lo siento, estoy teniendo problemas de conexi\xf3n. Por favor, intenta de nuevo m\xe1s tarde.")}};return(0,a.useEffect)(()=>{x()},[]),(0,a.useEffect)(()=>{i.current&&i.current.scrollTo({top:i.current.scrollHeight,behavior:"smooth"})},[t]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>o(!n),className:"fixed bottom-6 right-6 z-50 w-14 h-14 bg-[#ff6b35] hover:bg-[#e55a2a] text-white rounded-full shadow-lg flex items-center justify-center transition-all duration-200 hover:scale-110",children:n?(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}):(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),n&&(0,s.jsxs)("div",{className:"fixed bottom-24 right-6 z-50 w-96 h-[600px] bg-white rounded-lg shadow-2xl flex flex-col border border-gray-200 animate-in slide-in-from-bottom-4 duration-300",children:[(0,s.jsxs)("div",{className:"bg-[#0d475b] text-white p-4 rounded-t-lg flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-[#0a3845] rounded-full flex items-center justify-center",children:(0,s.jsx)(m,{})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold text-lg",children:"Chatbot ISTS"}),(0,s.jsx)("p",{className:"text-xs text-blue-100",children:"En l\xednea"})]})]}),(0,s.jsx)("button",{onClick:()=>o(!1),className:"text-white hover:bg-[#0a3845] rounded-full p-1 transition-colors",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsxs)("div",{ref:i,className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50",children:[(0,s.jsxs)("div",{className:"flex gap-3 items-start",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-[#0d475b] rounded-full flex items-center justify-center flex-shrink-0",children:(0,s.jsx)(c.A,{className:"w-4 h-4 text-white"})}),(0,s.jsx)("div",{className:"bg-white rounded-lg rounded-tl-none p-3 shadow-sm max-w-[80%]",children:(0,s.jsxs)("p",{className:"text-sm text-gray-800",children:["\xa1Hola! \uD83D\uDC4B ",(0,s.jsx)("br",{})," \xbfEn qu\xe9 puedo ayudarte hoy?"]})})]}),t.map((e,t)=>(0,s.jsx)(u,{chat:e},t))]}),(0,s.jsx)("div",{className:"p-4 border-t border-gray-200 bg-white rounded-b-lg",children:(0,s.jsx)(g,{chatHistory:t,setChatHistory:r,generateBotResponse:d})})]})]})}}},e=>{e.O(0,[741,137,441,255,358],()=>e(e.s=697)),_N_E=e.O()}]);